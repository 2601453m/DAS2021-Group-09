---
title: "project2"
author: "Jialin Sun, yiming lei, Yilin Liang, Ruilin Ma, Rachit Rakesh Khade"
date: "2021/7/23"
output:
  pdf_document:
    latex_engine: pdflatex
    number_sections: yes
  html_document:
    df_print: paged
  word_document: default
fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = TRUE, warning = FALSE, message = FALSE, comment = NA)
```

```{r libraries,echo = FALSE}
library(tidyverse)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(devtools)
library(magrittr)
library(ggplot2)
library(maps)
library(RColorBrewer)
library(viridis)
library(ggpubr)
library(GGally)
library(corrplot)
library(knitr)
library(olsrr)
library(data.table)
library(moderndive)
library(ggfortify)
library(diagram)
library(ggthemes)
library(cowplot)
library(showtext)
library(ggnewscale)
library(gapminder)
library(janitor)
```

```{R data, echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE}
#read the file
dat<-read.csv("dataset9.csv")
#add the score column,if rating>7,then 1,else 0
dat<-mutate(dat,score=ifelse(rating>7,1,0))
#replace NA with mean value in length column 
dat$length[is.na(dat$length)]<-mean(dat$length,na.rm = TRUE)
dat$scorename[dat$score==1] <- "greater than 7"
dat$scorename[dat$score==0] <- "lower than 7"
```

# Introduction {#sec:Intro}

With the gradual development of material life, the pursuit of human life is not only food and clothing, but also begins to have spiritual goals. Jackson T and Marks N. believe that people's life has shifted from material pursuit to spiritual pursuit in the past 40 years according to their consumption outlook (Jackson T, Marks N.1999). In recent years, watching movies has become an indispensable form of entertainment in most people's lives (Kubrak T.2020). A good movie can not only bring people happiness, but also usually reflect some social problems and phenomena. According to sociological analysis, film is not only a good medium to spread cultural and social phenomena, but also a kind of relaxed entertainment (Balabantaray S R.2014). If a film can engrave these phenomena into people's minds, it is vital to improve social conduct. In most movies, the social phenomena expressed in the movies are deeply engraved in the minds of audiences by bringing people emotions such as touching, happiness, sadness and memories (Homan R L.1997).

In order to make a better and more popular movie, this article will explore the influence factors of movie rating by analyzing 3001 movies from the IMDB movie database. IMDb, originally a hobby organization of international fan groups, is currently a website owned by Amazon and contains as much information as possible about every movie (Peralta v. 2007). According to the description of films in the database, it can be seen that they are related to the six main factors, which are year, running time, budget, number of positive votes, genre of film, and IMDB rating. Through the chart and the establishment of a generalized linear model to analyze the relationship between IMDB rating and several important factors affecting the rating, the rating score is equal to 7 as the critical boundary of the film quality, the most significant influencing factors, the results can be applied to the field of film production, but also conducive to social construction.

This paper mainly consists of six parts. The Section \ref{sec:Intro} is introduction. The Section \ref{sec:MET} is the main definition and method of the factors used in the analysis. The Section \ref{sec:EDA} is the exploratory data analysis of IMDB rating and these factors, and studies the relationship between them. In Section \ref{sec:FDA}, the generalized linear model (GLM) is used to analyze the data. The Section \ref{sec:Conc} is the summary of the analysis. The Section \ref{sec:REF} is the reference.

# Main Definitions And Method {#sec:MET}

## Population and Data {#sec:PAD}

### Population {#sec:POP}

3001 movies from the IMDB movie database

### Data Collection {#sec:DCO}

The data is from the IMDB movie database.
The variables are shown in the followed table.

```{r data1, echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE,out.width = 2}
#Please make a new table1
#table2

```
## Objective {#sec:OBJ}

```{r data3436, echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE,out.heighth='110%',out.width='110%'}

text_tbl <- data.frame(
  category = c("Dependent variable", "Dependent variable", "Independent variable", "Independent variable", "Independent variable", "Independent variable", "Independent variable"),
  variable = c(
    "film.id",
    "rating", 
    "year", 
    "length ", 
    "budget", 
    "votes", 
    "genre" 
  ),
  definition = c("The unique identifier for the film
", "IMDB rating from 0-10
", "Year of release of the film in cinemas", " Duration (in minutes)
", "Budget for the films production (in $1000000s)", "Number of positive votes received by viewers
", "Genre of the film
"),
  type = c(
    "classified variable",
    "continuous variable", 
    "continuous variable", 
    "continuous variable", 
    "continuous variable", 
    "continuous variable", 
    "classified variable"
  )
)

kable(text_tbl,caption = '\\label{tab:summaries1} variable definition') %>%
  kable_styling(full_width = F,latex_options = "hold_position", font_size = 8) %>%
  column_spec(1, bold = T, border_right = T) %>%
  column_spec(2, width = "6em")%>%
  column_spec(3, width = "10em")


```


### Primary Objective {#sec:PRO}

Analyze the reasons why IMDB score exceeds 7

### Secondary Objectives {#sec:SEO}

The influencing factors of IMDB rating were analyzed.
Analyze the relationship between the six relevant information of the film. They are year, running time, budget, number of positive votes, genre, and IMDB rating.

## Work-flow {#sec:FLOW}

```{r data2, echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE,out.heighth='80%',out.width='80%'}
pos <- coordinates(pos = c(5,5))
cc <- c("Introduction", "Definition\nAnd\nMethod","Exploratory\nData Analysis",
        "Formal Data\nAnalysis", "Conclusion","NULL", "NULL"," Pie chat,\nHistogram,\nBoxplot",
        "Correlation\nmatrix,\n(GLM) model"," NULL")
openplotmat(main = "Flow Chart")
straightarrow(from = pos[1,] ,to = pos[2,],lwd = 2, arr.pos = 0.6)
straightarrow(from = pos[2,] ,to = pos[3,],lwd = 2, arr.pos = 0.6)
straightarrow(from = pos[3,] ,to = pos[4,],lwd = 2, arr.pos = 0.6)
straightarrow(from = pos[4,] ,to = pos[5,],lwd = 2, arr.pos = 0.6)
straightarrow(from = pos[4,] ,to = pos[5,],lwd = 2, arr.pos = 0.6)
straightarrow(from = pos[3,] ,to = pos[8,],lwd = 2, arr.pos = 0.8)
straightarrow(from = pos[4,] ,to = pos[9,],lwd = 2, arr.pos = 0.8)
for(i in c(1, 2, 3, 4, 5)) textrect(pos[i,],radx = 0.08,rady = 0.1,shadow.size=0,lab = cc[i],cex=0.8)
for(i in c(8, 9)) textrect(pos[i,],radx = 0.08,rady = 0.1,shadow.size=0,lab = cc[i],cex=0.8)
```



